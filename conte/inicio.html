<!DOCTYPE html>
<!--
This is a starter template page. Use this page to start your new project from
scratch. This page gets rid of all links and provides the needed markup only.
-->
<html>
  <head>
    <meta charset="UTF-8">
    <title>Reportes</title>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
    <link href="../bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="http://code.ionicframework.com/ionicons/2.0.0/css/ionicons.min.css" rel="stylesheet" type="text/css" />
    <link href="../dist/css/AdminLTE.min.css" rel="stylesheet" type="text/css" />
    <link href="../dist/css/skins/_all-skins.min.css" rel="stylesheet" type="text/css" />
    <script src="../js/jquery-3.3.1.js"></script>
    <script src="Chart.bundle.js"></script>
    <script src="utils.js"></script>
    <style type="text/css">
      .inboxx{
        background-color: #dd4b39;
        display: block;
        width: 60%;
        margin-bottom: 15px;
        text-align: center;
        height: 60px;
        border-radius: 5px;
        margin-left: 15%;
      }
      .inboxx > b{
        font-size: 2em;
      }
      .inboxx > label{
        font-size: .8em;
      }
      .pre_contenido{
        text-align: center;
      }
      .pre_p{
        font-size: 2em;
        font-style: italic;
      }
    </style>
    <script type="text/javascript">
      $(document).ready(function(){

        $("#user").text(buscacook(" descrip"));
        $("#userdescrip").text(buscacook("user"));
        if (buscacook("user") !== undefined) {
          $("#cveunidadmin").append("<option selected value='"+buscacook("user")+"'>"+buscacook("user")+"</option>");
          $(".oculta_ft").hide();
        }
        /*$.ajax({
           type: "POST",
           processData: false,
           url: '../fun/sabana.php',
           cache: false,
           data: $(this).serialize(),
           success: function(dat)
           {
            //alert(dat);
          }
        });*/
      });
      var m_alto = [0,0,0,0,0,0,0,0];
      var m_7 = [];
      var m_5 = [];
      function descargar_dd(){
        emma();
        var link = window.document.createElement( 'a' ),
              url = canvas.toDataURL(),
              filename = $("#docente option:selected").text() + '.jpg';
       
          link.setAttribute( 'href', url );
          link.setAttribute( 'download', filename );
          link.style.visibility = 'hidden';
          window.document.body.appendChild( link );
          link.click();
          window.document.body.removeChild( link );
      }
      function pdf_gm_matriculas(){
        if ($("#cvegrupo").val() !== "0") {
          var urlp = 'pdf_gm_matriculas.html?dat_cvegrupo='+$("#cvegrupo").val()+"&periodoescolar="+$("#periodoescolar").val()+"&cvemodeloeducativo="+$("#cvemodeloeducativo").val()+"&cveunidadmin="+$("#cveunidadmin").val();
          var myWindow = window.open(urlp, "Servicio", "width=700, height=500");
        }else{
          alert("Selecciona un Grupo");
        }
      }
      function pdf_mpnc(){
        if ($("#matricula").val() !== "0") {
          var urlp = 'pdf_mpnc.html?mp_matricula='+$("#matricula").val()+"&cvemodeloeducativo="+$("#cvemodeloeducativo").val()+"&cveunidadmin="+$("#cveunidadmin").val();
          var myWindow = window.open(urlp, "Servicio", "width=700, height=500");
        }else{
          alert("Selecciona un Grupo");
        }
      }
      function pdf_gm_indicador(){
        if ($("#cvegrupo").val() !== "0") {
          var urlp = 'pdf_gm_indicador.html?dat_cvegrupo='+$("#cvegrupo").val()+"&periodoescolar="+$("#periodoescolar").val()+"&cvemodeloeducativo="+$("#cvemodeloeducativo").val()+"&cveunidadmin="+$("#cveunidadmin").val();
          var myWindow = window.open(urlp, "Servicio", "width=900, height=500");
        }else{
          alert("Selecciona un Grupo");
        }
      }
      function pdf_detalle_matricula(){
        if ($("#matricula").val() !== "0") {
          var urlp = 'pdf_detalle_matricula.html?dat_matricula='+$("#matricula").val()+"&cvegrupo="+$("#cvegrupo").val()+"&periodoescolar="+$("#periodoescolar").val()+"&cvemodeloeducativo="+$("#cvemodeloeducativo").val()+"&cveunidadmin="+$("#cveunidadmin").val()+"&m_5="+m_5+"&m_7="+m_7+"&m_alto="+m_alto;
          var myWindow = window.open(urlp, "Servicio", "width=900, height=500");
        }else{
          alert("Selecciona una Matrícula");
        }
      }
      function pdf_concentrado_nc(){
        if ($("#periodoescolar").val() !== "0") {
          var urlp = 'pdf_concentrado_nc.html?semestre='+$("#semestre").val()+"&periodoescolar="+$("#periodoescolar").val()+"&cvemodeloeducativo="+$("#cvemodeloeducativo").val()+"&cveunidadmin="+$("#cveunidadmin").val();
          var myWindow = window.open(urlp, "Servicio", "width=900, height=500");
        }else{
          alert("Selecciona un Periodo Escolar");
        }
      }
      function pdf_concentrado_p(){
        if ($("#periodoescolar").val() !== "0") {
          var urlp = 'pdf_concentrado_p.html?semestre='+$("#semestre").val()+"&periodoescolar="+$("#periodoescolar").val()+"&cvemodeloeducativo="+$("#cvemodeloeducativo").val()+"&cveunidadmin="+$("#cveunidadmin").val();
          var myWindow = window.open(urlp, "Servicio", "width=700, height=500");
        }else{
          alert("Selecciona un Periodo Escolar");
        }
      }
      function pdf_dd_grafica(){
        //alert($("#docente").val());
        var moddoc = $("#docente").val().split("|");
        if ($("#docente").val() !== "0") {
          var urlp = 'pdf_dd_grafica.html?dat_cvepsp='+moddoc[1]+"&cvemodulo="+moddoc[0]+"&cveplanestudio="+$("#cveplanestudio").val()+"&periodoescolar="+$("#periodoescolar").val()+"&cvemodeloeducativo="+$("#cvemodeloeducativo").val()+"&cveunidadmin="+$("#cveunidadmin").val()+"&m_alto="+m_alto[$("#docente").prop('selectedIndex') - 1];
          var myWindow = window.open(urlp, "Servicio", "width=700, height=500");
        }else{
          alert("Selecciona un Docente");
        }
      }
      function oc_cveentidad(){
        if ($("#cveentidad").val() !== "0") {
          $("#cveunidadmin").empty(); $("#cveunidadmin").append("<option value='0'>Selecciona</option>");  
          $.ajax({
             type: "POST",
             processData: false,
             url: '../fun/fun.php?dat_cveentidad='+$("#cveentidad").val(),
             cache: false,
             data: $(this).serialize(),
             success: function(data)
             {
              //alert(data);
              var datar = data.split("&");
              var arr_planteles = [];
              for (var i = 1; i < datar.length; i++) {
                var datarr = datar[i].split("|");
                arr_planteles.push(datarr[1] + "|" + datarr[0]);
              }
              arr_planteles.sort();
              for (var i = 0; i < arr_planteles.length; i++) {
                var datarr = arr_planteles[i].split("|");
                $("#cveunidadmin").append("<option value='" + datarr[1] + "'>" + datarr[0] + "</option>");  
              }
             }
          });
        }else{
          alert("Valor Invalido");
        }
      }
      function oc_cvemodeloeducativo(){
        //alert($("#cvemodeloeducativo").val());
        if ($("#cvemodeloeducativo").val() !== "0") {
          $("#periodoescolar").empty(); $("#periodoescolar").append("<option value='0'>Selecciona</option>");  
          $("#cveplanestudio").empty(); $("#cveplanestudio").append("<option value='0'>Selecciona</option>");  
          if ($("#cvemodeloeducativo").val() === "2018") {
            $("#periodoescolar").append("<option value='11819'>11819</option>");
            $("#periodoescolar").append("<option value='21819'>21819</option>");
          }else{
            $("#periodoescolar").append("<option value='11213'>11213</option><option value='21213'>21213</option><option value='11314'>11314</option><option value='21314'>21314</option><option value='11415'>11415</option><option value='21415'>21415</option><option value='11516'>11516</option><option value='21516'>21516</option><option value='11617'>11617</option><option value='21617'>21617</option><option value='11718'>11718</option><option value='21718'>21718</option><option value='11819'>11819</option><option value='21819'>21819</option>");
          };
          $.ajax({
             type: "POST",
             processData: false,
             url: '../fun/fun.php?dat_cvemodeloeducativo='+$("#cvemodeloeducativo").val()+"&cveunidadmin="+$("#cveunidadmin").val(),
             cache: false,
             data: $(this).serialize(),
             success: function(data)
             {
              //alert(data);
              var datar = data.split("&");
              for (var i = 1; i < datar.length; i++) {
                var datarr = datar[i].split("|");
                $("#cveplanestudio").append("<option value='" + datarr[0] + "'>" + datarr[1] + "</option>");  
              }
             }
          });
        }else{
          alert("Valor Invalido");
        }
      }
      function oc_periodoescolar(){
        if ($("#periodoescolar").val() !== "0") {
          $("#semestre").empty();
          $("#semestre").append("<option value='0'>Selecciona</option>");
          if ($("#periodoescolar").val().substring(0, 1) === "1"){
            $("#semestre").append("<option value='1'>1° Semestre</option>");
            $("#semestre").append("<option value='3'>3° Semestre</option>");
            $("#semestre").append("<option value='5'>5° Semestre</option>");
          }else{
            $("#semestre").append("<option value='2'>2° Semestre</option>");
            $("#semestre").append("<option value='4'>4° Semestre</option>");
            $("#semestre").append("<option value='6'>6° Semestre</option>");
          }
        }else{
          alert("Valor Invalido");
        }
      }
      function oc_cveplanestudio(){
        //alert($("#cvemodeloeducativo").val());
        if ($("#cveplanestudio").val() !== "0") {
          $("#cvegrupo").empty(); $("#cvegrupo").append("<option value='0'>Selecciona</option>");  
          $.ajax({
             type: "POST",
             processData: false,
             url: '../fun/fun.php?dat_cveplanestudio='+$("#cveplanestudio").val()+"&periodoescolar="+$("#periodoescolar").val()+"&cvemodeloeducativo="+$("#cvemodeloeducativo").val()+"&cveunidadmin="+$("#cveunidadmin").val(),
             cache: false,
             data: $(this).serialize(),
             success: function(data)
             {
              //alert(data);
              var datar = data.split("|");
              for (var i = 1; i < datar.length; i++) {
                $("#cvegrupo").append("<option value='" + datar[i] + "'>" + datar[i] + "</option>");  
              }
             }
          });
        }else{
          alert("Valor Invalido");
        }
      }
      function oc_cvegrupo(){
        m_alto = [0,0,0,0,0,0,0,0];
        m_7 = [];
        m_5 = [];
        //alert($("#cvegrupo").val());
        $("#encabezado").empty();
        $("#datos").empty(); 
        if ($("#cvegrupo").val() !== "0") {
          $("#docente").empty(); $("#docente").append("<option value='0'>Selecciona</option>");  
          $("#contenido").empty();
          $("#contenido").append("<section class='content-header'><h1>Reporte de Avance Grupo-Módulo<small>Sabana de calificaciones</small></h1></section><section class='content'><div class='row'><div class='col-xs-12'><div class='box'><div class='box-header'><div id='encabezado'></div></div><div class='box-body table-responsive no-padding'><row><table id='datos' class='table table-hover'></table></row></div></div></div></div></section>");
          $.ajax({
             type: "POST",
             processData: false,
             url: '../fun/sabana.php?dat_cvegrupo='+$("#cvegrupo").val()+"&periodoescolar="+$("#periodoescolar").val()+"&cvemodeloeducativo="+$("#cvemodeloeducativo").val()+"&cveunidadmin="+$("#cveunidadmin").val(),
             cache: false,
             data: $(this).serialize(),
             success: function(dat)
             {
              //alert(dat);
              var data = dat.split("%");
              $("#datos").append("<tr id='encabezado-tabla'></tr>");
              $("#encabezado-tabla").append("<th>Matricula</th><th>Nombre</th>");
              //**********************ANALISIS DE PORCENTAJES***********************
              //var m_alto = [0,0,0,0,0,0,0,0];
              //var m_7 = []; 
              //var m_5 = [];
              var datar = data[1].split("&");
              for (var i = 1; i < datar.length; i++) {
                var datarr = datar[i].split("|");
                if (parseFloat(datarr[2]) > m_alto[0]) {
                  m_alto[0] = datarr[2];
                }
                if (parseFloat(datarr[3]) > m_alto[1]) {
                  m_alto[1] = datarr[3];
                }
                if (parseFloat(datarr[4]) > m_alto[2]) {
                  m_alto[2] = datarr[4];
                }
                if (parseFloat(datarr[5]) > m_alto[3]) {
                  m_alto[3] = datarr[5];
                }
                if (parseFloat(datarr[6]) > m_alto[4]) {
                  m_alto[4] = datarr[6];
                }
                if (parseFloat(datarr[7]) > m_alto[5]) {
                  m_alto[5] = datarr[7];
                }
                if (parseFloat(datarr[8]) > m_alto[6]) {
                  m_alto[6] = datarr[8];
                }
                if (parseFloat(datarr[9]) > m_alto[7]) {
                  m_alto[7] = datarr[9];
                }
              }
              //alert(m_alto);
              for (var i = 0; i < m_alto.length; i++) {
                m_7.push((m_alto[i]*0.70).toFixed(2));
                m_5.push((m_alto[i]*0.50).toFixed(2));
              }
              //alert(m_5);
              //alert(m_7);
              //**********************COLOCA COLORES MATERIAS***********************
              var m_c = [0,0,0,0,0,0,0,0];
              var m_i = [0,0,0,0,0,0,0,0];
              var m_a = [0,0,0,0,0,0,0,0];
              var m_inb = false; m_inn = 0;
              var m_anb = false; m_ann = 0;
              var m_limpiosn = 0;
              for (var i = 1; i < datar.length; i++) {
                m_inb = false;
                m_anb = false;
                var datarr = datar[i].split("|");

                $("#datos").append("<tr id='"+datarr[0]+"'></tr>");

                $("#"+datarr[0]).append("<td>"+datarr[0]+"</td>");
                $("#"+datarr[0]).append("<td>"+datarr[1]+"</td>");
                //**********************COLOCA COLORES MATERIA 1***********************              
                if(parseFloat(datarr[2])<m_5[0]){
                  $("#"+datarr[0]).append("<td style='background-color: #f94141;'>"+datarr[2]+"</td>");
                  m_a[0]++;
                  m_anb = true;
                } 
                if(parseFloat(datarr[2])<m_7[0] && parseFloat(datarr[2])>=m_5[0]){
                  $("#"+datarr[0]).append("<td style='background-color: #fff300;'>"+datarr[2]+"</td>");
                  m_i[0]++;
                  m_inb = true;
                }
                if(parseFloat(datarr[2])>=m_7[0]){
                  $("#"+datarr[0]).append("<td>"+datarr[2]+"</td>");
                  m_c[0]++;
                }
                if (datarr[2] === "n/c") {
                  $("#"+datarr[0]).append("<td>"+datarr[2]+"</td>");
                }
                //**********************COLOCA COLORES MATERIA 2***********************
                if(parseFloat(datarr[3])<m_5[1]){
                  $("#"+datarr[0]).append("<td style='background-color: #f94141;'>"+datarr[3]+"</td>");
                  m_a[1]++;
                  m_anb = true;
                } 
                if(parseFloat(datarr[3])<m_7[1] && parseFloat(datarr[3])>=m_5[1]){
                  $("#"+datarr[0]).append("<td style='background-color: #fff300;'>"+datarr[3]+"</td>");
                  m_i[1]++;
                  m_inb = true;
                }
                if(parseFloat(datarr[3])>=m_7[1]){
                  $("#"+datarr[0]).append("<td>"+datarr[3]+"</td>");
                  m_c[1]++;
                }
                if (datarr[3] === "n/c") {
                  $("#"+datarr[0]).append("<td>"+datarr[3]+"</td>");
                }
                //**********************COLOCA COLORES MATERIA 3***********************
                if(parseFloat(datarr[4])<m_5[2]){
                  $("#"+datarr[0]).append("<td style='background-color: #f94141;'>"+datarr[4]+"</td>");
                  m_a[2]++;
                  m_anb = true;
                } 
                if(parseFloat(datarr[4])<m_7[2] && parseFloat(datarr[4])>=m_5[2]){
                  $("#"+datarr[0]).append("<td style='background-color: #fff300;'>"+datarr[4]+"</td>");
                  m_i[2]++;
                  m_inb = true;
                }
                if(parseFloat(datarr[4])>=m_7[2]){
                  $("#"+datarr[0]).append("<td>"+datarr[4]+"</td>");
                  m_c[2]++;
                }
                if (datarr[4] === "n/c") {
                  $("#"+datarr[0]).append("<td>"+datarr[4]+"</td>");
                }
                //**********************COLOCA COLORES MATERIA 4***********************
                if(parseFloat(datarr[5])<m_5[3]){
                  $("#"+datarr[0]).append("<td style='background-color: #f94141;'>"+datarr[5]+"</td>");
                  m_a[3]++;
                  m_anb = true;
                } 
                if(parseFloat(datarr[5])<m_7[3] && parseFloat(datarr[5])>=m_5[3]){
                  $("#"+datarr[0]).append("<td style='background-color: #fff300;'>"+datarr[5]+"</td>");
                  m_i[3]++;
                  m_inb = true;
                }
                if(parseFloat(datarr[5])>=m_7[3]){
                  $("#"+datarr[0]).append("<td>"+datarr[5]+"</td>");
                  m_c[3]++;
                }
                if (datarr[5] === "n/c") {
                  $("#"+datarr[0]).append("<td>"+datarr[5]+"</td>");
                }
                //**********************COLOCA COLORES MATERIA 5***********************
                if(parseFloat(datarr[6])<m_5[4]){
                  $("#"+datarr[0]).append("<td style='background-color: #f94141;'>"+datarr[6]+"</td>");
                  m_a[4]++;
                  m_anb = true;
                } 
                if(parseFloat(datarr[6])<m_7[4] && parseFloat(datarr[6])>=m_5[4]){
                  $("#"+datarr[0]).append("<td style='background-color: #fff300;'>"+datarr[6]+"</td>");
                  m_i[4]++;
                  m_inb = true;
                }
                if(parseFloat(datarr[6])>=m_7[4]){
                  $("#"+datarr[0]).append("<td>"+datarr[6]+"</td>");
                  m_c[4]++;
                }
                if (datarr[6] === "n/c") {
                  $("#"+datarr[0]).append("<td>"+datarr[6]+"</td>");
                }
                //**********************COLOCA COLORES MATERIA 6***********************
                if(parseFloat(datarr[7])<m_5[5]){
                  $("#"+datarr[0]).append("<td style='background-color: #f94141;'>"+datarr[7]+"</td>");
                  m_a[5]++;
                  m_anb = true;
                } 
                if(parseFloat(datarr[7])<m_7[5] && parseFloat(datarr[7])>=m_5[5]){
                  $("#"+datarr[0]).append("<td style='background-color: #fff300;'>"+datarr[7]+"</td>");
                  m_i[5]++;
                  m_inb = true;
                }
                if(parseFloat(datarr[7])>=m_7[5]){
                  $("#"+datarr[0]).append("<td>"+datarr[7]+"</td>");
                  m_c[5]++;
                }
                if (datarr[7] === "n/c") {
                  $("#"+datarr[0]).append("<td>"+datarr[7]+"</td>");
                }
                //**********************COLOCA COLORES MATERIA 7***********************
                if(parseFloat(datarr[8])<m_5[6]){
                  $("#"+datarr[0]).append("<td style='background-color: #f94141;'>"+datarr[8]+"</td>");
                  m_a[6]++;
                  m_anb = true;
                } 
                if(parseFloat(datarr[8])<m_7[6] && parseFloat(datarr[8])>=m_5[6]){
                  $("#"+datarr[0]).append("<td style='background-color: #fff300;'>"+datarr[8]+"</td>");
                  m_i[6]++;
                  m_inb = true;
                }
                if(parseFloat(datarr[8])>=m_7[6]){
                  $("#"+datarr[0]).append("<td>"+datarr[8]+"</td>");
                  m_c[6]++;
                }
                if (datarr[8] === "n/c") {
                  $("#"+datarr[0]).append("<td>"+datarr[8]+"</td>");
                }
                //**********************COLOCA COLORES MATERIA 8***********************
                if(parseFloat(datarr[9])<m_5[7]){
                  $("#"+datarr[0]).append("<td style='background-color: #f94141;'>"+datarr[9]+"</td>");
                  m_a[7]++;
                  m_anb = true;
                } 
                if(parseFloat(datarr[9])<m_7[7] && parseFloat(datarr[9])>=m_5[7]){
                  $("#"+datarr[0]).append("<td style='background-color: #fff300;'>"+datarr[9]+"</td>");
                  m_i[7]++;
                  m_inb = true;
                }
                if(parseFloat(datarr[9])>=m_7[7]){
                  $("#"+datarr[0]).append("<td>"+datarr[9]+"</td>");
                  m_c[7]++;
                }
                if (datarr[9] === "n/c") {
                  $("#"+datarr[0]).append("<td>"+datarr[9]+"</td>");
                }
                if (m_anb) {
                //alert("rojo");
                m_ann++;
                }
                if (m_inb) {
                  //alert("amarillo");
                  m_inn++;
                }
                if (m_anb || m_inb) {
                  //alert("Debe");
                }else{
                  //alert("Limpio");
                  m_limpiosn++; 
                }
              }
              //alert(m_limpiosn); 
              //alert(m_ann);
              //alert(m_inn);
              //alert(m_c);
              //alert(m_i);
              //alert(m_a);
              var totalalumnos = datar.length - 1;
              datar = data[0].split("&");
              $("#encabezado").append("<div class='row'><div class='col-md-10'><h3 class='box-title'>Indicador Grupo-Módulo</h3><b><span style='margin-left: 10%'>Grupo: "+$("#cvegrupo").val()+"</span><span style='margin-left: 15%'>Carrera: "+$("#cveplanestudio option:selected").text()+"</span></b><table id='tbl_cabeza' class='table table-hover' style=''></table></div><div class='col-md-2' style='margin-top: 2%'><div class='row'><div class='inboxx' style='background-color: grey;'><label>Total Alumnos</label><br><b>"+totalalumnos+"</b></div></div><div class='row'><div class='inboxx' style='background-color: #8ad841;'><label>Competentes</label><br><b>"+m_limpiosn+"</b></div></div><div class='row'><div class='inboxx' style='background-color: #fff300;'><label>Intersemestral</label><br><b>"+m_inn+"</b></div></div><div class='row'><div class='inboxx' style='background-color: #f94141;'><label>Asesorías Compl.</label><br><b>"+m_ann+"</b></div></div></div></div>");
              $("#tbl_cabeza").append("<tr><th>Siglema</th><th>Módulo</th><th>Docente</th><th>C</th><th style='background-color: #fff300;'>AI</th><th style='background-color: #f94141;'>AC</th><th>%+Alto</th><th>%MPC</th></tr>");
              
              for (var i = 1; i < datar.length; i++) {
                var datarr = datar[i].split("|");
                $("#tbl_cabeza").append("<tr><td>"+datarr[0]+"</td><td>"+datarr[1]+"</td><td>"+datarr[4]+"</td><td>"+m_c[i-1]+"</td><td>"+m_i[i-1]+"</td><td>"+m_a[i-1]+"</td><td>"+m_alto[i-1]+"</td><td>"+m_7[i-1]+"</td></tr>");
                $("#encabezado-tabla").append("<th>"+datarr[0]+"</th>");
                $("#docente").append("<option value='"+datarr[0]+"|"+datarr[3]+"'>"+datarr[0]+"|"+datarr[4]+"</option>");
              }
              $("#encabezado").append("<div class='row'><div class='col-md-12'><b><span style='margin-right: 50%; font-size: 1.5em;'>Lista de Grupo</span>Porcentajes Adquiridos por Módulo</b></div></div>");
             }
          });
          //*******************************************LISTA MATRICULAS**************************************************
          $("#matricula").empty(); $("#matricula").append("<option value='0'>Selecciona</option>");  
          $.ajax({
             type: "POST",
             processData: false,
             url: '../fun/fun.php?dat_cvegrupo='+$("#cvegrupo").val()+"&cveplanestudio="+$("#cveplanestudio").val()+"&periodoescolar="+$("#periodoescolar").val()+"&cvemodeloeducativo="+$("#cvemodeloeducativo").val()+"&cveunidadmin="+$("#cveunidadmin").val(),
             cache: false,
             data: $(this).serialize(),
             success: function(data)
             {
              //alert(data);
              var datar = data.split("|");
              for (var i = 1; i < datar.length; i++) {
                $("#matricula").append("<option value='" + datar[i] + "'>" + datar[i] + "</option>");  
              }
             }
          });
        }else{
          alert("Valor Invalido");
        }
      };
      function oc_matricula(){
        if ($("#matricula").val() !== "0") {
          $("#contenido").empty(); 
          $.ajax({
             type: "POST",
             processData: false,
             url: '../fun/sabana_matricula.php?dat_matricula='+$("#matricula").val()+"&cvegrupo="+$("#cvegrupo").val()+"&periodoescolar="+$("#periodoescolar").val()+"&cvemodeloeducativo="+$("#cvemodeloeducativo").val()+"&cveunidadmin="+$("#cveunidadmin").val(),
             cache: false,
             data: $(this).serialize(),
             success: function(dat)
             {
              //alert(dat);
              var data = dat.split("%");
              var datar1 = data[0].split("&");
              var datar2 = data[1].split("&");
              var datarr2 = datar2[1].split("|");
              $("#contenido").append("<section class='content-header'><h1>Reporte de Avance Matricula<small>Sabana de calificaciones</small></h1></section><section class='content'><div class='row' id='content_matricula'><div class='col-xs-10'><div class='box'><div class='box-header'><div id='encabezado'></div><h2 class='box-title'><b>"+datarr2[1]+"</b></h2></div><div class='box-body table-responsive no-padding'><row><table id='datos' class='table table-hover'></table></row></div></div></div></div></section>");
              $("#datos").append("<tr><th>Siglema</th><th>Módulo</th><th>Docente</th><th>Porcentaje de Avance</th><th>%MPC</th><th>%+Alto</th><tr>"); 

              var m_a = 0;
              var m_i = 0;
              for (var i = 1; i < datar1.length; i++) {
                var datarr1 = datar1[i].split("|");
                //$("#datos").append("<tr><td>"+datarr1[0]+"</td><td>"+datarr1[1]+"</td><td>"+datarr1[3]+"</td><td><b>"+datarr2[i+1]+"</b></td><td>"+m_7[i-1]+"</td><td>"+m_alto[i-1]+"</td><tr>");


                $("#datos").append("<tr id='"+datarr1[0]+"'></tr>");

                $("#"+datarr1[0]).append("<td>"+datarr1[0]+"</td>");
                $("#"+datarr1[0]).append("<td>"+datarr1[1]+"</td>");
                $("#"+datarr1[0]).append("<td>"+datarr1[3]+"</td>");
                //**********************COLOCA COLORES MATERIAS***********************              
                if(parseFloat(datarr2[i+1])<m_5[i-1]){
                  $("#"+datarr1[0]).append("<td style='background-color: #f94141;'><b>"+datarr2[i+1]+"</b></td>");
                  m_a++;
                } 
                if(parseFloat(datarr2[i+1])<m_7[i-1] && parseFloat(datarr2[i+1])>=m_5[i-1]){
                  $("#"+datarr1[0]).append("<td style='background-color: #fff300;'><b>"+datarr2[i+1]+"</b></td>");
                  m_i++;
                }
                if(parseFloat(datarr2[i+1])>=m_7[i-1]){
                  $("#"+datarr1[0]).append("<td><b>"+datarr2[i+1]+"</b></td>");
                }
                if (datarr2[i+1] === "n/c") {
                  $("#"+datarr1[0]).append("<td><b>"+datarr2[i+1]+"</b></td>");
                }
                $("#"+datarr1[0]).append("<td>"+m_7[i-1]+"</td>");
                $("#"+datarr1[0]).append("<td>"+m_alto[i-1]+"</td>");
              }
              $("#content_matricula").append("<div class='col-md-2' style='margin-top: 2%'><div class='row'><div class='inboxx' style='background-color: grey;'><label>Total Módulos</label><br><b>"+8+"</b></div></div><div class='row'><div class='inboxx' style='background-color: #8ad841;'><label>Módulos Competentes</label><br><b>"+(8-(parseInt(m_i)+parseInt(m_a)))+"</b></div></div><div class='row'><div class='inboxx' style='background-color: #fff300;'><label>Intersemestrales</label><br><b>"+m_i+"</b></div></div><div class='row'><div class='inboxx' style='background-color: #f94141;'><label>Asesorías Compl.</label><br><b>"+m_a+"</b></div></div></div>");
              
             }
          });
        }else{
          alert("Valor Invalido");
        }
      };
      var datos_pr = [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10];
      function oc_docente(){
        //alert($("#docente").prop('selectedIndex'));
        datos_pr = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
        var arr_may = 0;
        $("#contenido").empty();
        var moddoc = $("#docente").val().split("|");
        $.ajax({
           type: "POST",
           processData: false,
           url: '../fun/desempeno_docentes.php?dat_cvepsp='+moddoc[1]+"&cvemodulo="+moddoc[0]+"&cveplanestudio="+$("#cveplanestudio").val()+"&periodoescolar="+$("#periodoescolar").val()+"&cvemodeloeducativo="+$("#cvemodeloeducativo").val()+"&cveunidadmin="+$("#cveunidadmin").val(),
           cache: false,
           data: $(this).serialize(),
           success: function(data)
           {
              //alert(data);
              var datar = data.split("&");
              $("#contenido").append("<section class='content-header'><h1>Reporte de Desempeño Docente<small>Avance semanal</small></h1></section><section class='content'><div class='row'><div class='col-xs-12'><div class='box'><div class='box-header'><h2 class='box-title'><b>"+$("#docente option:selected").text()+"</b></h2><table id='tablam' class='table' style='width: 300px'></table></div><div class='box-body table-responsive no-padding'><div class='grafica'><canvas id='canvas'></canvas></div></div></div></div></div></section>");
              var num_ran_may = randomio(0, m_alto[$("#docente").prop('selectedIndex') - 1]);
              //alert(num_ran_may);
              for (var i = 1; i < datar.length; i++) {
                datarr = datar[i].split("|");
                if (i === (datar.length - 1)) {
                  datos_pr[parseInt(datarr[1])-1] = m_alto[$("#docente").prop('selectedIndex') - 1];
                }else{
                  num_ran_may = randomio(num_ran_may, ((m_alto[$("#docente").prop('selectedIndex') - 1]) * .4));
                  datos_pr[parseInt(datarr[1])-1] = num_ran_may;
                }
              }
              var config = {
                  type: 'line',
                  data: {
                      labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18'],
                      datasets: [{
                          label: 'Desempeño captado', //azul
                          borderColor: "#14384F",
                          backgroundColor: "#246289", //#05478a 05478a8c 25333a
                          data: datos_pr,
                
                      }, {
                          label: 'Diferencial', //amarillo
                          borderColor: "#CE9E51",
                              backgroundColor: "#F9BD5D",
                              data: [5.55, 11.1, 16.65, 22.2, 27.75, 33.3, 38.85, 44.4, 49.95, 55.5, 61.05, 66.6, 72.15, 77.7, 83.25, 88.8, 94.35, 100],
                  
                          }
                      ]
                  },
                  options: {
                      responsive: true,
                      title: {
                          display: true,
                          text: fech() + ' Registro de calificación docente: ' + $("#docente option:selected").text()
                
                      },             
                      scales: {
                          xAxes: [{
                              scaleLabel: {
                                  display: true,
                                  labelString: 'Semanas del periodo Escolar'
                              }
                          }],
                          yAxes: [{
                              ticks: {
                                  min: 0,
                                  max: 100,
                                  stepSize: 5
                              },
                              scaleLabel: {
                                  display: true,
                                  labelString: 'Porcentaje %'
                              }
                          }]
                      }
                  }
              };
              arr_may = 0;
              //alert(datos_pr);
              for (var i = 0; i < 18; i++) {
                if (datos_pr[i] > arr_may) {
                  arr_may = datos_pr[i];
                }else{
                  datos_pr[i] = arr_may;
                }
              }
              //alert(datos_pr);
              $("#tablam").append("<tr><th>Fecha Actualización</th><th>Semana</th><th>Porcentaje</th></tr>");
              for (var i = 1; i < datar.length; i++) {
                datarr = datar[i].split("|");
                //$("#tablam").append("<tr><td>"+datarr[0]+"</td><td>"+datarr[1]+"</td></tr>");
                $("#tablam").append("<tr><td>"+datarr[0]+"</td><td>"+datarr[1]+"</td><td>"+datos_pr[(parseInt(datarr[1]) - 1)]+"%</td></tr>");
              }
              var ctx = document.getElementById('canvas').getContext('2d');
              window.myLine = new Chart(ctx, config);

              //var imageObj = new Image();
              //imageObj.src = 'emma.jpg';  
              //ctx.drawImage( imageObj, 100, 100 );
              //var ctx = document.getElementById('canvas').getContext('2d');
              //ctx.beginPath();
              //ctx.arc(100,150,40,0,2*Math.PI);
              //ctx.stroke();
           }
        });
      }
      function randomio(m,n){
          m = parseInt(m);
          n = parseInt(n);
          return Math.floor( Math.random() * (n - m + 1) ) + m;
      }
      function fech(){
        var mo = ['ene', 'feb', 'mar', 'abr', 'may', 'jun', 'jul', 'ago', 'sep', 'oct', 'nov', 'dic'];
        var da = new Date();
        var di = da.getDate();
        var me = mo[da.getMonth()];
        var an = da.getYear();
        var ann = an.toString();
        var annn = ann.substring(1);
        return(di + "/" + me + "/" + annn);
      };
      function emma(){
        var ctx = document.getElementById('canvas').getContext('2d');

        var imageObj = new Image();
        imageObj.src = '../ima/conalep.png';  
        ctx.drawImage( imageObj, 50, 0 );
      }
      function limpiar(cook){
        alert("entra a borrar: " + cook);
        if (cook === undefined) {
          var cookies = document.cookie.split(";");
            for (var i = 0; i < cookies.length; i++) {
                alert("ema");
                var cookie = cookies[i];
                var eqPos = cookie.indexOf("=");
                var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
                document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
            }
        }else{
          document.cookie = cook + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
          document.cookie = " "+cook + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
        }
      };
      function buscacook(cook){
        var cooksep = (document.cookie).split(";");
        var cooksepa;
        for (var i = 0; i < cooksep.length; i++) {
          cooksepa = cooksep[i].split("="); 
          if (cook === cooksepa[0]) {
            //alert("cookie encontrada: " + cook + "\nvalor: " + cooksepa[1]);
            return cooksepa[1];
            break;
          }else{
            //alert("cookie NO encontrada: " + cook);
          }
        }
      };
      function alumno_mp(){
        if ($("#matricula").val() !== "0") {
          $("#contenido").empty(); 
          $.ajax({
             type: "POST",
             processData: false,
             url: '../fun/fun.php?mp_matricula='+$("#matricula").val()+"&cvemodeloeducativo="+$("#cvemodeloeducativo").val()+"&cveunidadmin="+$("#cveunidadmin").val(),
             cache: false,
             data: $(this).serialize(),
             success: function(data)
             {
              alert(data);
              if (data === "0") {
                $("#contenido").append("<section class='content-header'><h1>Reporte de Módulos NO Competentes<small>Reporte</small></h1></section><section class='content'><div class='row' id='content_matricula'><div class='col-xs-12'><div class='box'><div class='box-header'><div id='encabezado'></div><h2 id='nom_alum' class='box-title'><b>Alumno sin Módulos no competentes</b></h2></div><div class='box-body table-responsive no-padding'><row><h1></h1></row></div></div></div></div></section>");
              }else{
                var datar = data.split("&");
                $("#contenido").append("<section class='content-header'><h1>Reporte de Módulos NO Competentes<small>Reporte</small></h1></section><section class='content'><div class='row' id='content_matricula'><div class='col-xs-10'><div class='box'><div class='box-header'><div id='encabezado'></div><h2 id='nom_alum' class='box-title'><b></b></h2></div><div class='box-body table-responsive no-padding'><row><table id='datos' class='table table-hover'></table></row></div></div></div></div></section>");
                $("#datos").append("<tr><th>Periodo Escolar</th><th>Módulo</th><th>Porcentaje final</th><th>Fecha</th><tr>"); 

                for (var i = 1; i < datar.length; i++) {
                  var datarr = datar[i].split("|");
                  $("#datos").append("<tr><td>"+datarr[0]+"</td><td>"+datarr[2]+"</td><td>"+datarr[4]+"</td><td>"+datarr[5]+"</td></tr>"); 
                  $("#nom_alum").text(datarr[1]);
                }
              }
             }
          });
        }else{
          alert("Valor Invalido");
        }
      };

      
    </script>
    <style type="text/css">
      .txt-barra{
        color: white;
        font-size: 1.3em;
      }
    </style>

  </head>
  <body class="skin-blue">
    <div class="wrapper">
      <!-- Main Header -->
      <div style="position: absolute; color: white; z-index: 2000; width: 230px; text-align: center;">
        <img src="../ima/conalep.png" width="80">
        <!--<h3>Potenciometro</h3>-->
      </div>
      <!-- Left side column. contains the logo and sidebar -->
      <aside class="main-sidebar">
        <!-- sidebar: style can be found in sidebar.less -->
        <section class="sidebar">
          <!-- Sidebar user panel (optional) -->
          <br>
          <div class="user-panel">
            <div class="pull-left image">
              <img src="../dist/img/usertotal.png" class="img-circle" alt="User Image" />
            </div>
            <div class="pull-left info">
              <p><label id="user">Administrativo</label></p>
              <!-- Status -->
              <i class="fa fa-circle text-success"></i><label id="userdescrip"> Administrativo</label> 
              <br>
              <a href="..">Cerrar Sesión</a>
            </div>
          </div>
          <!-- /.search form -->
          <!--<button onclick="alert(document.cookie);">cook</button>-->
          <!-- Sidebar Menu -->
          <ul class="sidebar-menu">
            <li class="header">FILTROS</li>
            <!-- Optionally, you can add icons to the links -->
            <li class="txt-barra oculta_ft">Entidad</li>
            <li class="active oculta_ft">
              <select id="cveentidad" class="form-control" onchange="oc_cveentidad()">
                <option value='0'>Selecciona</option>
                <option value="1">Aguascalientes</option>
                <option value="2">Baja California</option>
                <option value="3">Baja California Sur</option>
                <option value="4">Campeche</option>
                <option value="5">Coahuila de Zaragoza</option>
                <option value="6">Colima</option>
                <option value="7">Chiapas</option>
                <option value="8">Chihuahua</option>
                <option value="9">Ciudad de México</option>
                <option value="10">Durango</option>
                <option value="11">Guanajuato</option>
                <option value="12">Guerrero</option>
                <option value="13">Hidalgo</option>
                <option value="14">Jalisco</option>
                <option value="15">México</option>
                <option value="16">Michoacán de Ocampo</option>
                <option value="17">Morelos</option>
                <option value="18">Nayarit</option>
                <option value="19">Nuevo León</option>
                <option value="20">Oaxaca</option>
                <option value="21">Puebla</option>
                <option value="22">Querétaro de Arteaga</option>
                <option value="23">Quintana Roo</option>
                <option value="24">San Luis Potosí</option>
                <option value="25">Sinaloa</option>
                <option value="26">Sonora</option>
                <option value="27">Tabasco</option>
                <option value="28">Tamaulipas</option>
                <option value="29">Tlaxcala</option>
                <option value="30">Veracruz Llave</option>
                <option value="31">Yucatán</option>
                <option value="32">Zacatecas</option>
              </select>
            </li>
            <li class="txt-barra oculta_ft">Plantel</li>
            <li class="oculta_ft">
              <select id="cveunidadmin" class="form-control">
                <option value='0'>Selecciona</option>
              </select>
            </li>
            <li class="txt-barra">Modelo Académico</li>
            <li>
              <select id="cvemodeloeducativo" class="form-control" onchange="oc_cvemodeloeducativo()">
                <option value='0'>Selecciona</option>
                <option value="2003">2003</option>
                <option value="2008">2008</option>
                <option value="2018">2018</option>
              </select>
            </li>
            <li class="txt-barra">Periodo Escolar</li>
            <li>
              <select id="periodoescolar" class="form-control" onchange="oc_periodoescolar()">
                <option value='0'>Selecciona</option>
              </select>
            </li>
            <li class="txt-barra">Carrera</li>
            <li>
              <select id="cveplanestudio" class="form-control" onchange="oc_cveplanestudio()">
                <option value='0'>Selecciona</option>
              </select>
            </li>
            <li class="txt-barra">Grupo</li>
            <li>
              <select id="cvegrupo" class="form-control" onchange="oc_cvegrupo()">
                <option value='0'>Selecciona</option>
              </select>
            </li>
            <li class="txt-barra">Desempeño Docente</li>
            <li>
              <select id="docente" class="form-control" onchange="oc_docente()">
                <option value='0'>Selecciona</option>
              </select>
            </li>
            <li class="txt-barra">Matrícula</li>
            <li>
              <select id="matricula" class="form-control" onchange="oc_matricula()">
                <option value='0'>Selecciona</option>
              </select>
            </li>
            <li class="txt-barra">Semestre</li>
            <li>
              <select id="semestre" class="form-control" onchange="oc_semestre()">
                <option value='0'>Selecciona</option>
              </select>
            </li>
            <br>
            <br>
            <li><button class="btn btn-block btn-info btn-lg" onclick="descargar_dd();">RC Docente</button></li>
            <br>
            <li><button class="btn btn-block btn-success btn-lg" onclick="pdf_gm_indicador();">IReprobación G</button></li>
            <br>
            <li><button class="btn btn-block btn-primary btn-lg" onclick="pdf_gm_matriculas();">RGM </button></li>
            <br>
            <li><button class="btn btn-block btn-info btn-lg" onclick="pdf_detalle_matricula();">Alumno</button></li>
            <br>
            <li><button  class="btn btn-block btn-info btn-lg" onclick='alumno_mp()'>alumno_mp</button></li>
            <br>
            <li><button  class="btn btn-block btn-info btn-lg" onclick='pdf_mpnc()'>pdf_mpnc</button></li>
            <br>
            <li><button class="btn btn-block btn-danger btn-lg" onclick="pdf_concentrado_nc();">R-GM Docente</button></li>
            <br>
            <li><button class="btn btn-block btn-danger btn-lg" onclick="pdf_concentrado_p();">Alumnos C, NC</button></li>
            <br>
           
            
          </ul><!-- /.sidebar-menu -->
        </section>
        <!-- /.sidebar -->
      </aside>

      <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper" id="contenido">
        <div class="pre_contenido">
          <img src="../ima/fondo_2_1.jpg" style="width: 100%; opacity: 1;">
          <div class="grafica">
              <canvas id="canvas"></canvas>
          </div>
        </div>
      </div>

      <!-- Main Footer -->

    </div><!-- ./wrapper -->

    <!-- REQUIRED JS SCRIPTS -->
    
    <!-- jQuery 2.1.3 -->
    <script src="../plugins/jQuery/jQuery-2.1.3.min.js"></script>
    <!-- FastClick -->
    <script src='../plugins/fastclick/fastclick.min.js'></script>
    <!-- AdminLTE App -->
    <script src="../dist/js/app.min.js" type="text/javascript"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="../dist/js/demo.js" type="text/javascript"></script>

    <script>
        /* ===== Logic for creating fake Select Boxes ===== */
        $('.sel').each(function () {
            $(this).children('select').css('display', 'none');

            var $current = $(this);

            $(this).find('option').each(function (i) {
                if (i == 0) {
                    $current.prepend($('<div>', {
                        class: $current.attr('class').replace(/sel/g, 'sel__box')
                    }));

                    var placeholder = $(this).text();
                    $current.prepend($('<span>', {
                        class: $current.attr('class').replace(/sel/g, 'sel__placeholder'),
                        text: placeholder,
                        'data-placeholder': placeholder
                    }));

                    return;
                }

                $current.children('div').append($('<span>', {
                    class: $current.attr('class').replace(/sel/g, 'sel__box__options'),
                    text: $(this).text()
                }));
            });
        });

        // Toggling the `.active` state on the `.sel`.
        $('.sel').click(function () {
            $(this).toggleClass('active');
        });

        // Toggling the `.selected` state on the options.
        $('.sel__box__options').click(function () {
            var txt = $(this).text();
            var index = $(this).index();

            $(this).siblings('.sel__box__options').removeClass('selected');
            $(this).addClass('selected');

            var $currentSel = $(this).closest('.sel');
            $currentSel.children('.sel__placeholder').text(txt);
            $currentSel.children('select').prop('selectedIndex', index + 1);
        });
    </script>

    <script>
        var days = ['15-ago', '31-ago', '14-sep', '01-oct', '15-oct', '01-nov', '16-nov', '30-nov', '19-dic'];
        

        
    </script>
  </body>
</html>